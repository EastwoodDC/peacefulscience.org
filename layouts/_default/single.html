

{{ define "head" }}
{{ partial "jsonld" . }} 
{{ end }}



{{ define "main" }}
{{ $PAGES := partialCached "byviews" . }}

{{ with .Description  }}
  {{ if in . "..." }}
    {{ warnf "DESC.ELLIPSE\t%s" $.File.Path }}
  {{ end }}
{{ end }}

{{ $headerpos :=  .Params.headerImage.Position | default "main" }}

<div class="d-print-block d-none mb-5" id="pageHeader"><img  width="40%" src="partial `imgcdn`  `/img/2019/07/PS-logo-long-black.png`"></img></div>

<div class="article-grid">
<div class="left-sidebar" style="height: 100%;">

  <div style="position: relative; height: min(100vh, 80%);">
      <div class="d-none d-md-block" style="position: absolute; top:0px; width: 100%; height: 100%;"></div>
     
     {{- if eq "sidebar" $headerpos -}}
      <div  class="w-100 position-sticky" style="top:100px">
      {{- with .Params.headerImage.Src }}
          {{  $src := partial "imgurl" (dict "src"  . "loc" $.File.Path ) }}
          <img src="{{ $src  | partial `imgcdn`  }}" class="w-100"  style="height: auto" 
             {{-  with (index site.Data.imgsize $src)  }} width="600" height="{{  div (mul .height 600) .width }}" {{ end -}} 
          ></img>
      {{- end }}
      {{- with .Params.headerImage.Credit }}
          <div class="text-muted text-smaller w-100 pl-2">{{ . | markdownify }}</div>
      {{- end }}
      </div>
     {{- end -}}
      
   <!--    <div class="d-none d-md-block" style="position: absolute; top:20%; width: 100%; height: 81%; background-image: linear-gradient(#f3f3f300,#f3f3f3ff); pointer-events: none"></div> -->
  </div>
  <div style="position: relative; height: max(calc(100% - 100vh ), 20%)">
   <div class="d-none d-md-block  hover-front position-sticky" style="top: 50px; width: 100%; background: #white">
      
	<nav class="toc navbar  pt-5 pr-0" > 
            {{ .Page.TableOfContents | replaceRE "<li>" "<li class='nav-item'>"  | replaceRE "<ul>" "<ul class='nav'>"  | replaceRE  "<nav .*?>"  ""  | replaceRE  "</nav>"  ""| replaceRE "<a " "<a class='nav-link' "   | safeHTML }}
            <svg class="toc-marker" width="200" height="200" xmlns="http://www.w3.org/2000/svg">
				<path stroke="#080" stroke-width="3" fill="transparent" stroke-dasharray="0, 0, 0, 1000" stroke-linecap="round" stroke-linejoin="round" transform="translate(-0.5, -0.5)" />
			</svg>
	</nav>	  		  
    <script defer src="/js/navprogress.js"></script>

    </div>
    <div class="d-none d-md-block" style="z-index: 10; position: absolute; top:0%; width: 100%; height: calc( 100% + 1px); background-image: linear-gradient(#fff0,#fff0,#ffff); pointer-events: none"></div>
  </div>
</div>
<div class="title-bar">
    

    <div class="article-date d-inline"> {{ .PublishDate.Format "January 2, 2006" }} </div>
       {{ with .Scratch.Get "Views" }}
    <div class="view-count d-inline d-print-none float-right text-right"> {{ lang.FormatNumber 0 . }}</div>
    {{ end }}

    <h1 id="title" class="article-title mt-2">{{ .Params.page_title | default .Title | markdownify }}</h1>

    <div class="article-description mb-3">{{- .Description | markdownify -}} </div>
    
     {{- if eq "main" $headerpos -}}   
        <div class="pb-3">
        {{- with .Params.headerImage }}
          
          {{- $src := partial "imgurl" (dict "src"  .src "loc" $.File.Path )  -}}

          {{- with .youtube }}
             {{ partial `youtube` (slice  . ($src  | partial `imgcdn`)  ) }}
          {{- else -}}
            <img src="{{ $src  | partial `imgcdn`   }}" class="webfeedsFeaturedVisual"  style="width: 100%; height: auto" 
               {{-  with (index site.Data.imgsize $src)  }} width="600" height="{{  div (mul .height 600) .width }}" {{ end -}} 
            ></img>     
          {{- end -}}

        {{- end -}}      
      {{- with .Params.headerImage.Credit }}
          <div class="text-muted text-smaller w-100 text-right" >{{ $.RenderString .  }}</div>
      {{- end }}
        </div>
     {{- end -}}
    
    <div class="mb-2 pr-1 ">  
      {{ partial "authors" (dict "authors" .Params.authors)  }}
    </div>
        
    <div class="mb-5">
    {{- range .Params.categories }}
      {{- with site.GetPage "taxonomyTerm" (printf "categories/%s" (urlize .)) }}
        <a class="tag-link" href="{{ .Permalink }}"> {{ .Title }} </a>
      {{- end }}
    {{- end }}
    </div>

  
</div>
<article class="article-cell pb-5 clearfix" style="z-index:10">

      
      {{ with  .Params.series }}
       {{ with site.GetPage "taxonomyTerm" .  }}
         <div class="series aside-xl-right bg-white">
         <p> <a class="font-special text-dark" href="{{.Permalink}}">{{ .Title }} </a>
         <ol class="text-smaller">
         {{- range  .Data.Pages.ByDate }}
          <li> {{ if not (eq $ .) }} <a href="{{ .Permalink }}">{{else}} <a href="#title" class="text-dark font-special">{{ end }}{{ .Title }}{{ if not (eq $ .) }} </a> {{else}}</a>{{ end }} </li>
         {{ end }}
         </ol></div>
        {{ end }}
      {{ end }}
      
      {{ .Content }}
</article>
 <!--  
<div class="right-sidebar pb-5 pr-5" style="position: relative">
   {{ partial "mailinglist" (dict "EmailClass" "text-dark pl-3" "ButtonClass"  "text-muted" )  }} 


    <div class="d-none d-md-block w-100" style="position: absolute; top:calc(100% - 1000px); height: min(1000px, 100%); background-image: linear-gradient(#fff0,#fffd,#ffff); pointer-events: none"></div>
</div>
-->
</div>


<div class="mt-5 py-5 comment-block d-print-none">
<div class="container" >
  <div class="row justify-content-center py-3 my-3 text-larger">
    <div class="col-lg-4 text-center text-lg-right">
    
          {{  $src := `/img/design/wood-chair-transparent.png`  }}
    <img src='{{ partial `imgcdn` $src }}' height="240" loading="lazy"
            {{-  with (index site.Data.imgsize $src)  }} width="{{  div (mul .width 240) .height }}"{{ end -}}
          ></img>   
          
          
	</div>
    <div class="col-lg-8 py-3 text-center text-lg-left">
    <h3>Join the conversation...</h3>
    
    <p> Come to understand and to be understood. <br> 
    Whatever your personal beliefs, we saved a chair for you. 
    <p>
      {{ with .Params.commenturl -}}
      <a href="{{ . | safeURL }}" target="_blank" class="font-special my-3 btn btn-primary btn-md">Discuss on Forum</a> {{ end }}
      <a href="{{ printf `%sedit/master/content/%s` site.Params.baseGitHub .File.Path | safeURL }}" rel=”nofollow” target="_blank" class="font-special my-3 btn btn-primary btn-md">Suggest Changes</a>
      <a href="{{ printf `%scommits/master/content/%s` site.Params.baseGitHub .File.Path  | safeURL }}" rel=”nofollow” target="_blank" class="font-special my-3 btn btn-primary btn-md">Revision History</a>
    </div>
  </div>
</div>
</div>


{{ $related := .Site.RegularPages.Related . | first 3 }}
<div class="d-print-none" style="background-color: white; min-height:1000">
<div class="container pt-5" >
  <div class="row justify-content-center pb-5 text-larger">
  
      <div class="pt-3 col-12 text-center">
      <h1 class="mb-5"> Related articles...</h1>
      </div >
	  {{ range $related }}
        {{ partial "render" (dict "Page" .  "Style" "vertical" "Layout"  "col-md-4" ) }}
	  {{ end }}

  </div>
</div>
</div>


{{- end }}
